<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>INSOMNIHACK CTF Teaser 2016 Write Up - Smartcat1 &#8211; NUS Greyhats</title>
<meta name="description" content="INSOMNIHACK CTF Teaser 2016 Write Up - Smartcat1">
<meta name="keywords" content="INSOMNIHACK, CTF">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="INSOMNIHACK CTF Teaser 2016 Write Up - Smartcat1">
<meta name="twitter:description" content="INSOMNIHACK CTF Teaser 2016 Write Up - Smartcat1">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://nusgreyhats.github.io/write-ups/images/icon.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="INSOMNIHACK CTF Teaser 2016 Write Up - Smartcat1">
<meta property="og:description" content="INSOMNIHACK CTF Teaser 2016 Write Up - Smartcat1">
<meta property="og:url" content="https://nusgreyhats.github.io/write-ups/INSOMNIHACK-CTF-Teaser-2016-Write-Up-Smartcat1/">
<meta property="og:site_name" content="NUS Greyhats">





<link rel="canonical" href="https://nusgreyhats.github.io/write-ups/INSOMNIHACK-CTF-Teaser-2016-Write-Up-Smartcat1/">
<link href="https://nusgreyhats.github.io/write-ups/feed.xml" type="application/atom+xml" rel="alternate" title="NUS Greyhats Feed">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://nusgreyhats.github.io/write-ups/assets/css/main.css">
<!-- Webfonts -->
<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="https://nusgreyhats.github.io/write-ups/assets/js/vendor/html5shiv.min.js"></script>
  <script src="https://nusgreyhats.github.io/write-ups/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<link href="https://nusgreyhats.github.io/write-ups/assets/css/font-awesome.css" rel="stylesheet" type="text/css">
<script src="https://nusgreyhats.github.io/write-ups/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://nusgreyhats.github.io/write-ups/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://nusgreyhats.github.io/write-ups/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://nusgreyhats.github.io/write-ups/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://nusgreyhats.github.io/write-ups/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://nusgreyhats.github.io/write-ups/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://nusgreyhats.github.io/write-ups/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav class="main-nav-outer animated drop" id="site-nav"><!--main-nav-start-->
		    <ul class="main-nav">
		        <li class="small-logo"><a href="https://nusgreyhats.github.io/write-ups/../#header"><img src="https://nusgreyhats.github.io/write-ups/images/icon.png" alt=""></a></li>
		        <li><a href="https://nusgreyhats.github.io/write-ups/">Write Ups</a></li>
		        <li><a href="https://nusgreyhats.github.io/write-ups/../#security-wednesdays">Security Wednesdays</a></li>
		        <li><a href="https://nusgreyhats.github.io/write-ups/../#the-ctf">The CTF</a></li>
		        <li><a href="https://nusgreyhats.github.io/write-ups/../#team">Team</a></li>
		        <li><a href="https://nusgreyhats.github.io/write-ups/../#contact">Contact</a></li>

		        
		        <li class="social">
		            <a href="https://facebook.com/groups/nusgreyhats/" class="facebook"><i class="fa fa-facebook"></i></a>
		        </li>
		        
		    </ul>
	</nav>
</div>
	
<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="https://nusgreyhats.github.io/write-ups/tags/#INSOMNIHACK" title="Pages tagged INSOMNIHACK">INSOMNIHACK</a>&nbsp;&bull;&nbsp;<a href="https://nusgreyhats.github.io/write-ups/tags/#CTF" title="Pages tagged CTF">CTF</a></span>
        
          <h1 class="entry-title">INSOMNIHACK CTF Teaser 2016 Write Up - Smartcat1</h1>
        
      </header>
      <footer class="entry-meta">
        
          
              
                  
              
          
              
          
              
          
              
          
        
        
          <img src="https://nusgreyhats.github.io/write-ups/images/bio-photo.jpg" class="bio-photo" alt="Xue Hui bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Xue Hui</span></span>
        <span class="entry-date date published"><time datetime="2016-01-20T00:00:00+08:00"><i class="fa fa-calendar-o"></i> January 20, 2016</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=INSOMNIHACK,CTF&amp;text=INSOMNIHACK%20CTF%20Teaser%202016%20Write%20Up%20-%20Smartcat1&amp;url=https://nusgreyhats.github.io/write-ups/INSOMNIHACK-CTF-Teaser-2016-Write-Up-Smartcat1/" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://nusgreyhats.github.io/write-ups/INSOMNIHACK-CTF-Teaser-2016-Write-Up-Smartcat1/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=https://nusgreyhats.github.io/write-ups/INSOMNIHACK-CTF-Teaser-2016-Write-Up-Smartcat1/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->
        
      </footer>
      <div class="entry-content">
        <h5 id="goalto-find-the-file-which-holds-information-on-the-flag">Goal:	To find the file which holds information on the flag.</h5>

<h5 id="line-of-thought-find-a-way-to-input-multiple-commands-into-the-shell-so-that-you-can-do-other-things-like-ls-instead-of-only-just-pinging">Line of thought: Find a way to input multiple commands into the shell so that you can do other things like “ls” instead of only just pinging.</h5>

<hr />

<h5 id="utools-usedu"><u>Tools used:</u></h5>
<ul>
  <li>Google Chrome console</li>
  <li>ASCII table</li>
  <li>Some CMD knowledge </li>
</ul>

<h3 id="preparation-stage">Preparation Stage</h3>
<hr />
<p>I started this problem by typing some things into the textbox that was available on the website. Some simple choices I started with was “localhost” and “ccc” just to see what I could ping/what would happen. I also tried some other special characters to see if I could input special commands or anything.
I managed to conclude the following based on the error messages:</p>

<ul>
  <li>These characters are blocked:  <code>$;&amp;|({`\t</code></li>
  <li>The textbox acts like a bash/shell in linux, because of the ping –c 1 “xxxx” </li>
</ul>

<p>Next, in order to gain more information about how the form works, I inspected the page by opening up the console, and changing the form method from “POST” to “GET”, so that I could see how the form values appear in the website link. </p>

<p>With the help of some basic command line knowledge and an ASCII table, one knows that we can type multiple commands into the shell by using “;” and “&amp;&amp;”, but we know that these 2 characters are blocked. Thus, the only option left is to use “\n”, also known as the newline character. Which means, insert the command into a new line. Using the ASCII table, we find that the hexadecimal value of the newline is %0A. </p>

<h3 id="get-the-flag-stage">Get the Flag Stage</h3>
<hr />
<p>After that, I did a http://smartcat.insomnihack.ch/cgi-bin/index.cgi?dest=localhost%0Als to list whatever was in the current directory. We see that there is a directory called “there”, but we don’t know how deep the flag is in “there” as there could be multiple subdirectories.</p>

<p>So, I did a a http://smartcat.insomnihack.ch/cgi-bin/index.cgi?dest=localhost%0Afind to list everything in the current directory (including sub-directories), and many subdirectories will show up, but only one of them is the flag. Although the deepest item does not have a file extension, there is no harm trying to cat the file to see if it contains the flag. </p>

<p>Run something like this: <a href="http://smartcat.insomnihack.ch/cgi-bin/index.cgi?dest=localhost%0Acat&lt;./there/.../file">http://smartcat.insomnihack.ch/cgi-bin/index.cgi?dest=localhost%0Acat&lt;./there/…/file</a></p>

<p>just like how you can do something like ./a.out&lt;input1.in </p>

<p>and bingo! the flag will be displayed on the website:</p>

<p><b>INS{warm_kitty_smelly_kitty_flush_flush_flush} </b></p>


        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'nusgreyhat';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="https://nusgreyhats.github.io/write-ups/32C3-CTF-Flash-(Reversing-300)/" class="btn" title="32C3 CTF - Flash (Reversing 300)">Previous</a>
      
      
        <a href="https://nusgreyhats.github.io/write-ups/x-ctf-2016-qualifiers-by-nus-greyhats/" class="btn" title="Write ups for X-CTF 2016 Qualifiers by NUS Greyhats">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->



<footer class="footer">
	<div class="container">
		<span class="copyright">© NUS GreyHats • Theme By W3Goods</span>
		<div class="social-icons">
			
			<a href="https://facebook.com/groups/nusgreyhats/" title="NUS Greyhats on Facebook" target="_blank"><i class="fa fa-facebook-square fa-2x"></i></a>
			
			
			
			
			
			<a href="https://github.com/nusgreyhats" title="NUS Greyhats on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
			
			
			
			<a href="https://nusgreyhats.github.io/write-ups/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
		</div><!-- /.social-icons -->
		<!--Copyright © 2014 Knight Theme By <a href="#">W3Goods</a>.-->
	</div>
</footer>


<script type="text/javascript">
  var BASE_URL = 'https://nusgreyhats.github.io/write-ups';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://nusgreyhats.github.io/write-ups/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67874722-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>
