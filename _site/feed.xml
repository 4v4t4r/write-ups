<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
	<channel>
		<title>NUS GreyHats</title>
		<description>NUS GreyHats is a newly formed special interest group designed to spark students&#39; interest in information security and advance the level of security proficiency towards the aim of contributing to the growing need for cyber defenders in the government and private sectors.</description>
		<link>http://www.nusgreyhats.org</link>
		<atom:link href="http://www.nusgreyhats.org/feed.xml" rel="self" type="application/rss+xml" />
		
			<item>
				<title>ASIS CTF Finals 2015 - Big Lie (Forensics 100)</title>
				
				
					<description>&lt;h1 id=&quot;big-lie&quot;&gt;Big Lie&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Points:&lt;/strong&gt;100&lt;br /&gt;
&lt;strong&gt;Category:&lt;/strong&gt; Forensics&lt;br /&gt;
Find the &lt;a href=&quot;http://www.nusgreyhats.org/write-ups/resources/asis/biglie.pcap&quot;&gt;flag&lt;/a&gt;.&lt;br /&gt;
MD5: c3037269053e61e10a2a2457051519c8&lt;/p&gt;

</description>
				
				<pubDate>Mon, 12 Oct 2015 00:00:00 +0800</pubDate>
				<link>http://www.nusgreyhats.org/ASISCTF-Final-2015-Big-Lie-(Forensics-100)/</link>
				<guid isPermaLink="true">http://www.nusgreyhats.org/ASISCTF-Final-2015-Big-Lie-(Forensics-100)/</guid>
			</item>
		
			<item>
				<title>CSAW CTF Qualifications 2015 - pcapin (Forensics 150)</title>
				
				
					<description>&lt;h1&gt;pcapin&lt;/h1&gt;
&lt;p&gt;We have extracted a pcap file from a network where attackers were present. We know they were using some kind of file transfer protocol on TCP port 7179. Weâ€™re not sure what file or files were transferred and we need you to investigate. We do not believe any strong cryptography was employed.&lt;/p&gt;

&lt;p&gt;Hint: The file you are looking for is a png &lt;a href=&quot;/write-ups/resources/wu/csaw2015/pcapin_73c7fb6024b5e6eec22f5a7dcf2f5d82.pcap&quot;&gt;pcapin_73c7fb6024b5e6eec22f5a7dcf2f5d82.pcap&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;
This challenge has surprisingly few solves. 41 out of 1000+ registered teams. We are given a pcap file with a few request/response from a client to a server and we have to figure out what is being sent.
&lt;/p&gt;

&lt;p&gt;Analyzing the flow of the data being transferred, we can infer that two request are sent to the server and after each request, the server will send a series of packets as response.
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/write-ups/img/res/wu/csaw2015/pcapin-tcpstream.png&quot; width=&quot;50%&quot; /&gt;&lt;/p&gt;

&lt;h2&gt;Request 1&lt;/h2&gt;
&lt;pre&gt;
00:08:00:00:07:31:f9:e9
&lt;/pre&gt;

&lt;h2&gt;Request 2&lt;/h2&gt;
&lt;pre&gt;
00:3a:00:00:15:02:f9:e9:8f:95:88:9e:c7:89:87:9e:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9:e9:f9
&lt;/pre&gt;
&lt;p&gt;
We see that request 1 is 8 bytes in length and coincidentally, there is also 00:08 in the data. Looking at the second request, we also see 00:3a in the same place. 3a is 58 in decimal and this correspond to the size of the request. Looking at the responses, we are also able to divide it into &quot;packets&quot; based on the size in the first 2 bytes. Another thing to note is that there appears to be an overwhelming amount of &quot;f9:e9&quot; in both the requests and in the first set of response from the server. This would infer that &quot;f9:e9&quot; is either the padding or the key since when XORed with null, it remains the same. We are able to verify that that is true by xoring with each of the packets in the first set of responses.
&lt;/p&gt;

&lt;pre&gt;
document.pdf
sample.tif
outfile.dat
grey_no_firewall.zip
flag.png
resume.pdf
god.pcapng
malware.exe
&lt;/pre&gt;

&lt;table class=&quot;highlighttable&quot;&gt;&lt;tr&gt;&lt;td class=&quot;linenos&quot;&gt;&lt;div class=&quot;linenodiv&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
	
	&lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;xor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xor&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hex&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;
In the output, we noticed that there was a file named &quot;flag.png&quot;. We can also see that the last 50 bytes of request 2 is identical to the section of cipher text that gets translated into &quot;flag.png&quot;.
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/write-ups/img/res/wu/csaw2015/pcapin-flagcipher.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;
Thinking that we solved it, we processed all packets in response 2 the same way as how we solve response 1 but it resulted in gibberish data. Since we know that we need a png file, we then tried to &quot;guess&quot; the key by taking the data segment of the first packet in the response and xoring the first 8 bytes with the png header. Getting a series of &quot;3f:50&quot; back, we used it as a key but it again resulted in gibberish data. Undaunted, we again look deeper into the responses and noticed that they all have the same size. However, it is unlikely that the original data can be divided that nicely so it would probably be padded at the end. Looking at the last packet of response 2, we can see a series of &quot;6c:4c&quot; but that is also not the correct key. We then look for differences between packets in response 1 versus those in response 2 and noticed something unusual. In response 1, byte 3,4 are both &quot;00:00&quot; in all instances but in response 2, they are all different. 
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/write-ups/img/res/wu/csaw2015/pcapin-byte34.png&quot; width=&quot;30%&quot; height=&quot;30%&quot; /&gt;&lt;/p&gt;
&lt;p&gt;
Looking deeper, we realize that f9+45+1 = 13f -&amp;gt; 3f and e9+67=150 -&amp;gt; 50. Again verifying that with the last packet, f9+72+1=16c -&amp;gt; 6c and e9+63=14c -&amp;gt; 4c. Finally, using this new information, we found the flag!.
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/write-ups/img/res/wu/csaw2015/pcapin-flag.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;A s1mp!3_n37w0rk_c4@113nge that was not simple at all!&lt;/p&gt;

&lt;table class=&quot;highlighttable&quot;&gt;&lt;tr&gt;&lt;td class=&quot;linenos&quot;&gt;&lt;div class=&quot;linenodiv&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;f9&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;e9&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;k1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;k2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;k1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;k2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;xor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xor&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;ans2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;binascii&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a2b_hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ans2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;flag.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Click &lt;a href=&quot;/write-ups/resources/wu/csaw2015/pcapin_data_raw.txt&quot;&gt;here&lt;/a&gt; for the raw data found in the pcap.&lt;/p&gt;

</description>
				
				<pubDate>Fri, 09 Oct 2015 00:00:00 +0800</pubDate>
				<link>http://www.nusgreyhats.org/CSAW-CTF-Qual-2015-pcapin-(Forensics-150)/</link>
				<guid isPermaLink="true">http://www.nusgreyhats.org/CSAW-CTF-Qual-2015-pcapin-(Forensics-150)/</guid>
			</item>
		
			<item>
				<title>TrendMicroCTF - VirusClicker (Offensive 200)</title>
				
				
					<description>&lt;h2&gt;Click Button! Attack Virus!&lt;/h2&gt;
&lt;p&gt;&lt;b&gt;Points:&lt;/b&gt; 200 &lt;b&gt;Category:&lt;/b&gt; Offensive &lt;b&gt;Description:&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;
&lt;a href=&quot;/write-ups/resources/VirusClicker.apk&quot;&gt;VirusClicker&lt;/a&gt;&lt;br /&gt;
MD5: 1a0462c2bc27bdd3a5045036c36c3e31&lt;/p&gt;
&lt;hr /&gt;

&lt;h1&gt;Solution&lt;/h1&gt;
&lt;p&gt;
	After downloading the APK and installing it on my BlueStacks Emulator, you see this screen that requires us to press on the button for 10&#39;000&#39;000 times...
&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;/write-ups/img/res/virusclicker.png&quot; height=&quot;300px&quot; /&gt;&lt;img src=&quot;/write-ups/img/res/10mclicks.png&quot; height=&quot;300px&quot; /&gt;&lt;/center&gt;
&lt;p&gt;
	We first use apktool to decompile the apk into the respective smali code. &lt;br /&gt;
	&lt;img src=&quot;/write-ups/img/res/apkdecode.png&quot; width=&quot;50%&quot; height=&quot;50%&quot; /&gt;&lt;br /&gt;
	The part of the code that we&#39;re interested in is the onTouchEvent that is called on every press.
&lt;/p&gt;
&lt;pre&gt;
.method public onTouchEvent(Landroid/view/MotionEvent;)Z
    .locals 4
    const/4 v3, 0x1
    invoke-virtual {p1}, Landroid/view/MotionEvent;-&amp;gt;getAction()I
    move-result v0
    packed-switch v0, :pswitch_data_0
    :cond_0
    :goto_0
    return v3
    :pswitch_0
    iput-boolean v3, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;h:Z
    goto :goto_0
    :pswitch_1
    const/4 v0, 0x0
    iput-boolean v0, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;h:Z
    iget v0, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    add-int/lit8 v0, v0, 0x1
    iput v0, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    invoke-static {}, Lcom/tm/ctf/clicker/a/a;-&amp;gt;b()V
    const/16 v0, 0xeb9
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-eq v0, v1, :cond_1
    const/16 v0, 0x2717
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-eq v0, v1, :cond_1
    const v0, 0xe767
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-eq v0, v1, :cond_1
    const v0, 0x186a3
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-eq v0, v1, :cond_1
    const v0, 0x78e75
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-eq v0, v1, :cond_1
    const v0, 0xf4243
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-eq v0, v1, :cond_1
    const v0, 0x98967f
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-ne v0, v1, :cond_2
    :cond_1
    new-instance v0, Landroid/content/Intent;
    const-string v1, &quot;com.tm.ctf.clicker.SCORE&quot;
    invoke-direct {v0, v1}, Landroid/content/Intent;-&amp;gt;&amp;lt;init&amp;gt;(Ljava/lang/String;)V
    const-string v1, &quot;SCORE&quot;
    iget v2, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;-&amp;gt;putExtra(Ljava/lang/String;I)Landroid/content/Intent;
    iget-object v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;a:Landroid/content/Context;
    invoke-virtual {v1, v0}, Landroid/content/Context;-&amp;gt;sendBroadcast(Landroid/content/Intent;)V
    :cond_2
    const v0, 0x989680
    iget v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;g:I
    if-gt v0, v1, :cond_0
    invoke-static {}, Landroid/os/Message;-&amp;gt;obtain()Landroid/os/Message;
    move-result-object v0
    new-instance v1, Ljava/lang/StringBuilder;
    iget-object v2, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;q:Ljava/lang/String;
    invoke-static {v2}, Ljava/lang/String;-&amp;gt;valueOf(Ljava/lang/Object;)Ljava/lang/String;
    move-result-object v2
    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-&amp;gt;&amp;lt;init&amp;gt;(Ljava/lang/String;)V
    const-string v2, &quot;Jh&quot;
    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;-&amp;gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    invoke-virtual {v1}, Ljava/lang/StringBuilder;-&amp;gt;toString()Ljava/lang/String;
    move-result-object v1
    iput-object v1, v0, Landroid/os/Message;-&amp;gt;obj:Ljava/lang/Object;
    iget-object v1, p0, Lcom/tm/ctf/clicker/activity/c;-&amp;gt;b:Landroid/os/Handler;
    invoke-virtual {v1, v0}, Landroid/os/Handler;-&amp;gt;sendMessage(Landroid/os/Message;)Z
    goto :goto_0
    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_0
        :pswitch_1
    .end packed-switch
	.end method 
&lt;/pre&gt;
&lt;p&gt;
	From the code, we can see that something will happen after we hit 0x989680 (10&#39;000&#39;000) clicks.&lt;br /&gt;
	Also, it seems that there are &quot;mini-checkpoints&quot; that you&#39;re suppose to hit at 0xeb9, 0x2717, 0xe767, 0x186a3, 0x78e75, 0xf4243, 0x98967f. What I am going to do is to patch the APK such that upon the first touch event, I am going to invoke all the necessary instructions to show me the flag.
&lt;/p&gt;
&lt;pre&gt;
	const v0, 0x989680
    const v1, 0x989680
    if-gt v0, v1, :cond_0
&lt;/pre&gt;
&lt;p&gt;
	The same for all the &quot;mini-checkpoints&quot;. &lt;br /&gt;
	We then use apktool to recompile the smali code back to .apk and then use jarsigner to sign it with a key we generated.&lt;br /&gt;
	&lt;img src=&quot;/write-ups/img/res/apksign.png&quot; /&gt;&lt;br /&gt;&lt;br /&gt;
	We then install the &quot;patched&quot; apk onto the BlueStacks emulator and tada! We got the flag!
&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;/write-ups/img/res/virusflag.png&quot; height=&quot;300px&quot; /&gt;&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;
	&lt;b&gt;TMCTF{Congrats_10MClicks}&lt;/b&gt;
&lt;/p&gt;

</description>
				
				<pubDate>Thu, 08 Oct 2015 00:00:00 +0800</pubDate>
				<link>http://www.nusgreyhats.org/TrendMicroCTF-VirusClicker-(Offensive-200)/</link>
				<guid isPermaLink="true">http://www.nusgreyhats.org/TrendMicroCTF-VirusClicker-(Offensive-200)/</guid>
			</item>
		
			<item>
				<title>TrendMicroCTF - 500 Captchas! (Misc 300)</title>
				
				
					<description>&lt;h1&gt;Welcome to Captcha Challenge!&lt;/h1&gt;
&lt;p&gt;The challenge description was a website, upon entering the website, you are allowed to register/sign in.&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;
	After registering and logging in, you are shown a captcha, and it seems that the challenge was to solve 500 consecutive captchas without any mistakes. However, it seems that you are able to skip captchas by refreshing the page (this turned out to be very useful).&lt;br /&gt;&lt;br /&gt;
	Captchas looks like this:
&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;/write-ups/img/res/captcha.png&quot; width=&quot;30%&quot; height=&quot;30%&quot; /&gt;&lt;img src=&quot;/write-ups/img/res/captcha2.png&quot; width=&quot;30%&quot; height=&quot;30%&quot; /&gt;&lt;/center&gt;
&lt;p&gt;
	To automatically solve all 500 captchas, we wrote a python script using the Python Imaging Library. The trick to solving the captchas was to do some pre-processing and to build a dataset of good characters which we will be using to solve new captchas.	
	&lt;br /&gt;
	&lt;h3&gt;Processing&lt;/h3&gt;
	&lt;b&gt;Turn background/noise to white, and text to black&lt;/b&gt;
	Scan the entire picture and rank the colours by frequency, the background colour would have the highest frequency followed by the text
&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;/write-ups/img/res/processed.jpg&quot; width=&quot;30%&quot; height=&quot;30%&quot; /&gt;&lt;/center&gt;
&lt;p&gt;
	&lt;b&gt;Dynamically slice the image by characters&lt;/b&gt;
  For each X coordinate, if the Y coordinates along the X coordinate has a black pixel:&lt;br /&gt;
  set inLetter = true&lt;br /&gt;
  Keep going along X until you reach a X where there is no black pixel along it, then you have your starting and ending x coordinate for your character!
&lt;/p&gt;

</description>
				
				<pubDate>Thu, 08 Oct 2015 00:00:00 +0800</pubDate>
				<link>http://www.nusgreyhats.org/TrendMicroCTF-500-Captchas!-(Misc-300)/</link>
				<guid isPermaLink="true">http://www.nusgreyhats.org/TrendMicroCTF-500-Captchas!-(Misc-300)/</guid>
			</item>
		
			<item>
				<title>Capture The Flag 101 Workshop</title>
				
				
					<description>&lt;center&gt;&lt;img src=&quot;/write-ups/img/thectf.jpg&quot; width=&quot;50%&quot; height=&quot;50%&quot; /&gt;&lt;/center&gt;
&lt;p&gt;
NUS Greyhats Capture The Flag 101 is a capture-the-flag (CTF) style workshop that will be spanned over two Saturdays. Participants will learn techniques and tools to exploit software vulnerabilities to uncover secret flags hidden in various challenge. This workshop is designed to be progressive and is beginner friendly. In addition, we will have a live CTF scoreboard to show your ranking :)  
&lt;/p&gt;
&lt;p&gt;
You can sign up for the event &lt;a href=&quot;https://docs.google.com/forms/d/1ppvnaRWzhwuSZ60CIKem4E37eyLQMbfltEw_xmutMBU/&quot;&gt;here&lt;/a&gt; (while stocks last).
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;Date:&lt;/b&gt; 15 and 22 August 2015&lt;br /&gt;
&lt;b&gt;Time:&lt;/b&gt; 1PM - 5PM&lt;br /&gt;
&lt;b&gt;Venue:&lt;/b&gt; School of Computing COM 1 Seminar Room 3 &lt;br /&gt;
(Registration from 12.30PM onwards)
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;15 August 2015&lt;/b&gt;&lt;br /&gt;
This session will focus on systems security which includes topics in source code auditing, representation of code as data, exploitation of insecure scripts, exploitation of format string bugs, and exploitation of memory corruption bugs.
&lt;/p&gt;

</description>
				
				<pubDate>Sun, 09 Aug 2015 00:00:00 +0800</pubDate>
				<link>http://www.nusgreyhats.org/Capture-The-Flag-101-Workshop/</link>
				<guid isPermaLink="true">http://www.nusgreyhats.org/Capture-The-Flag-101-Workshop/</guid>
			</item>
		
			<item>
				<title>POLICTF 2015 Write Up - John the Traveller (Web)</title>
				
				
					<description>&lt;div class=&quot;holder&quot;&gt;   
				&lt;p&gt;
					Holidays are here! But John still hasn&#39;t decided where to spend them and time is running out: flights are overbooked and prices are rising every second. Fortunately, John just discovered a website where he can book last second flight to all the European capitals; however, there&#39;s no time to waste, so he just grabs his suitcase and thanks to his new smartphone he looks the city of his choice up while rushing to the airport. There he goes! Flight is booked so... hauskaa lomaa! &lt;br /&gt;&lt;br /&gt;
					&lt;a href=&quot;http://traveller.polictf.it/&quot;&gt;http://traveller.polictf.it/&lt;/a&gt;
				&lt;/p&gt;
				&lt;hr /&gt;
	
				&lt;p&gt;
					We visited the site and saw the following page. &lt;br /&gt;&lt;br /&gt;
					&lt;/p&gt;&lt;center&gt;&lt;img src=&quot;/write-ups/img/travellersite.JPG&quot; width=&quot;50%&quot; height=&quot;50%&quot; /&gt;&lt;/center&gt;
				&lt;p&gt;&lt;/p&gt;
				&lt;br /&gt;
				&lt;p&gt;
				We tried to key into some arbitrary city, however, it returns back the same page. Looking back at the challenge description, we noticed something that stands out - &lt;b&gt;hauskaa lomaa&lt;/b&gt;. A search revealed that these two words is actually Finnish. We also found out that the capital of Finland is &lt;b&gt;Helsinki&lt;/b&gt;. Entering that into the search field and we got ....
					&lt;br /&gt;&lt;br /&gt;
					&lt;/p&gt;&lt;center&gt;&lt;img src=&quot;/write-ups/img/helsinki.JPG&quot; width=&quot;75%&quot; height=&quot;75%&quot; /&gt;&lt;/center&gt;
				&lt;p&gt;&lt;/p&gt;
				
				&lt;br /&gt;
				&lt;p&gt;
					Great. So the next step is to try and book the ticket. But how do we do so? The price is in px. Does it mean pixels?  The challenge also mentioned &quot;he just grabs his suitcase and thanks to his new smartphone&quot;. Let&#39;s try to adjust our browser size to one of the pixel size using Chrome browser dev tools. 
					&lt;br /&gt;&lt;br /&gt;
					&lt;/p&gt;&lt;center&gt;&lt;img src=&quot;/write-ups/img/devtools.JPG&quot; width=&quot;25%&quot; height=&quot;25%&quot; /&gt;&lt;/center&gt;
				&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
</description>
				
				<pubDate>Mon, 03 Aug 2015 00:00:00 +0800</pubDate>
				<link>http://www.nusgreyhats.org/polictf-2015-write-up-john-the-traveller-(web)/</link>
				<guid isPermaLink="true">http://www.nusgreyhats.org/polictf-2015-write-up-john-the-traveller-(web)/</guid>
			</item>
		
	</channel>
</rss>
